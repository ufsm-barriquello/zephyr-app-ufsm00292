# ğŸ”§ DiÃ¡rio de Erros e SoluÃ§Ãµes (Troubleshooting)

Durante o desenvolvimento, diversos obstÃ¡culos tÃ©cnicos foram encontrados. Abaixo, documento os principais erros, suas causas raÃ­zes e as soluÃ§Ãµes adotadas. Este registro serve como base de conhecimento para evitar problemas similares no futuro.

## 1. Problemas de Build e Estrutura (West)
* **âŒ Sintoma:** Erros genÃ©ricos ao rodar `west build`, dÃºvida se eram erros crÃ­ticos ou apenas *warnings*.
* **ğŸ” Causa:** DiretÃ³rio da aplicaÃ§Ã£o incorreto (flag `-s` apontando errado) ou pasta de build "suja" com resÃ­duos de compilaÃ§Ãµes anteriores.
* **âœ… SoluÃ§Ã£o:**
    * Adotar o comando padrÃ£o limpo: `west build -b samd21_xpro -p -s <caminho_da_app>`.
    * Sempre conferir o diretÃ³rio atual (`pwd`) antes de iniciar o build.
* **ğŸ’¡ Aprendizado:** Separar claramente o cÃ³digo-fonte da pasta de build evita conflitos de cache.

## 2. Mentalidade Bare-Metal vs. Device Tree
* **âŒ Sintoma:** O cÃ³digo compilava, mas os pinos/LEDs nÃ£o respondiam. Acesso direto a registradores causava comportamentos inesperados.
* **ğŸ” Causa:** Tentativa de programar pensando em "Bare-Metal" puro, ignorando o modelo de drivers do Zephyr e a descriÃ§Ã£o de hardware via Device Tree (DT).
* **âœ… SoluÃ§Ã£o:**
    * Uso de **Aliases** e **Labels** definidos no DT em vez de hardcodar nÃºmeros de pinos.
    * UtilizaÃ§Ã£o das APIs nativas (ex: `gpio_pin_configure`, `DEVICE_DT_GET`).
* **ğŸ’¡ Aprendizado:** O Zephyr exige uma descriÃ§Ã£o declarativa do hardware. Menos "gambiarra" em registrador, mais portabilidade via DT.

## 3. IntegraÃ§Ã£o do BTLC1000 (ConfiguraÃ§Ã£o BLE)
* **âŒ Sintoma:** Falha ao compilar samples como `peripheral_hr`. Erros ligados a drivers faltantes.
* **ğŸ” Causa:** A integraÃ§Ã£o BLE em um RTOS nÃ£o Ã© automÃ¡tica; exige a configuraÃ§Ã£o correta do mÃ³dulo (Shield) no `prj.conf` e suporte da board.
* **âœ… SoluÃ§Ã£o:**
    * Estudo da documentaÃ§Ã£o de Shields do Zephyr.
    * Ajuste fino das opÃ§Ãµes de Kconfig para habilitar a stack Bluetooth correta para o controlador externo.

## 4. Inferno de DependÃªncias e VersÃµes
* **âŒ Sintoma:** Ambiente "instalado", mas builds gerando mensagens estranhas.
* **ğŸ” Causa:** VersÃµes incompatÃ­veis de Python, CMake ou Toolchain. VariÃ¡veis de ambiente (PATH) apontando para instalaÃ§Ãµes antigas ou duplicadas.
* **âœ… SoluÃ§Ã£o:**
    * VerificaÃ§Ã£o rigorosa com `west --version`, `cmake --version`.
    * PadronizaÃ§Ã£o do uso do PowerShell dentro da pasta raiz do projeto.
* **ğŸ’¡ Aprendizado:** Em grandes projetos RTOS, 50% dos erros iniciais sÃ£o de ambiente, nÃ£o de cÃ³digo.

## 5. Mistura de Ãrvore do Zephyr vs. AplicaÃ§Ã£o
* **âŒ Sintoma:** Tentar compilar "o Zephyr inteiro" ou apontar o build para pastas genÃ©ricas.
* **ğŸ” Causa:** ConfusÃ£o entre a raiz do repositÃ³rio do RTOS e a pasta da minha aplicaÃ§Ã£o especÃ­fica.
* **âœ… SoluÃ§Ã£o:**
    * Manter uma estrutura de workspace clara (`zephyrproject/`) com subpastas definidas.
    * Apontar o `-s` sempre para a aplicaÃ§Ã£o final (ex: `samples/bluetooth/peripheral_nus`).

## 6. Device Tree Overlay (SAMD21 + BTLC1000)
* **âŒ Sintoma:** Builds quebrando com mensagens de "Node not found" ou propriedades invÃ¡lidas.
* **ğŸ” Causa:** CÃ³pia de *overlays* (.overlay) de outras placas sem ajustar os nomes dos nÃ³s (labels) para a SAMD21.
* **âœ… SoluÃ§Ã£o:**
    * ComparaÃ§Ã£o do overlay com exemplos oficiais.
    * Ajuste manual dos barramentos (SPI/UART) e GPIOs para corresponder ao esquema elÃ©trico da `samd21_xpro`.
* **ğŸ’¡ Aprendizado:** O Device Tree Ã© sensÃ­vel a nomes. Qualquer *typo* quebra o build.

## 7. InterpretaÃ§Ã£o de Logs
* **âŒ Sintoma:** PÃ¢nico ao ver centenas de linhas de log e *warnings* no final do build.
* **ğŸ” Causa:** Falta de estratÃ©gia para filtrar a saÃ­da verbosa do CMake/Ninja.
* **âœ… SoluÃ§Ã£o:**
    * Procurar primeiro por palavras-chave: `error:` e `failed`.
    * Analisar warnings recorrentes, mas focar no erro que interrompe o processo.
* **ğŸ’¡ Aprendizado:** Ler log Ã© uma habilidade tÃ£o importante quanto codificar.

---
